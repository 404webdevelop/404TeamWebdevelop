<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="/static/json2.js"></script>
<!--source from https://github.com/douglascrockford/JSON-js/blob/master/json2.js -->
</head>

<body>
<button>获得 JSON 数据</button>
<p></p>

<p id="show_json"></p>
<p><input id = "username"type="text" name="login" value="" placeholder="Username or Email"></p>
<p><input id= "password"type="password" name="password" value="" placeholder="Password"></p>
<button id="but">Default Button</button>
data shows:
<p id= "show"></p>
error shows:
<p id= "error"></p>
response:
<p id= "response"></p>
username:
<p id= "u"></p>
pass:
<p id= "p"></p>

<script type="text/javascript">
var token ;
/*$(document).ready(function(){
    $("#but").click(function(data){
        var data = {"username": "zuo2", "password": "zuoyu1039"};
        //console.log(data);
        var url = "api-token/";
        $.ajax({
          method: "POST",
          url: url,
          data: data,

        })
         .done(function (data) {
            console.log(data);
            $("#show").html(JSON.stringify(data));

         });
    });
    $("#error").html(JSON.stringify(token));

});
$("#error").html(JSON.stringify(data));*/

var username = "zuo2";
var password =  "zuoyu1039";



$(document).ready(function(){
    $("#but").click(function(data){

        
        var data = {"username": "zuo2", "password": "zuoyu1039"};
        //console.log(data);
        var url = "api-token/";
        var callback = "";
        getlogin(url,data,callback);
        var token=getCookie("token");
        console.log(token);
        $("#error").html(token);


         
    });


});





var username = "zuo2";
var password =  "zuoyu1039";
var url = "api-token/";
var data = {"username": "zuo2", "password": "zuoyu1039"};






function resetuser(username){
  username = "";
  return username;
}


function resetuser(password){
  password = "";
  return password;
}

function setCookie(username,password,token){
  document.cookie = "username = "+username+"; token="+token;
};

function getCookie(cname) {
    var name = cname + "=";
    console.log(name);
    var ca = document.cookie.split(';');
    console.log(ca);
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}



function getlogin(url,data,callback){
  var val;
  $.ajax({
          method: "POST",
          url: url,
          data: data,

        })
         .done(function (callback) {
            username = "zuo2";
            password = "zuoyu1039";
            
            //console.log(callback);
            var token =JSON.stringify(callback);
           // console.log(username);
            //console.log(password);
            //console.log(token);
            setCookie(username,password,token);


         });
  
  //return callback;

};

</script>

</body>
</html>
